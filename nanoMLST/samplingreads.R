data=c(rep('NB01PB01',61269),
rep('NB01PB02',39741),
rep('NB01PB03',33282),
rep('NB01PB04',12679),
rep('NB01PB05',71124),
rep('NB01PB06',12959),
rep('NB01PB07',50653),
rep('NB01PB08',24601),
rep('NB02PB01',86004),
rep('NB02PB02',49246),
rep('NB02PB03',61454),
rep('NB02PB04',19569),
rep('NB02PB05',96244),
rep('NB02PB06',38104),
rep('NB02PB07',90464),
rep('NB02PB08',41347),
rep('NB03PB01',22864),
rep('NB03PB02',3666),
rep('NB03PB03',2032),
rep('NB03PB04',1501),
rep('NB03PB05',16920),
rep('NB03PB06',2615),
rep('NB03PB07',8307),
rep('NB03PB08',2764),
rep('NB04PB01',111819),
rep('NB04PB02',63998),
rep('NB04PB03',63243),
rep('NB04PB04',15030),
rep('NB04PB05',91095),
rep('NB04PB06',48669),
rep('NB04PB07',80883),
rep('NB04PB08',49097),
rep('NB05PB01',101061),
rep('NB05PB02',60597),
rep('NB05PB03',40647),
rep('NB05PB04',15760),
rep('NB05PB05',62207),
rep('NB05PB06',35369),
rep('NB05PB07',57836),
rep('NB05PB08',38479),
rep('NB06PB01',107815),
rep('NB06PB02',80641),
rep('NB06PB03',65160),
rep('NB06PB04',21272),
rep('NB06PB05',73446),
rep('NB06PB06',41808),
rep('NB06PB07',83330),
rep('NB06PB08',49603),
rep('NB07PB01',107570),
rep('NB07PB02',49336),
rep('NB07PB03',35709),
rep('NB07PB04',11930),
rep('NB07PB05',82197),
rep('NB07PB06',37873),
rep('NB07PB07',39966),
rep('NB07PB08',36964),
rep('NB08PB01',115048),
rep('NB08PB02',79572),
rep('NB08PB03',72787),
rep('NB08PB04',30969),
rep('NB08PB05',92182),
rep('NB08PB06',61642),
rep('NB08PB07',99157),
rep('NB08PB08',42768),
rep('NB09PB01',99486),
rep('NB09PB02',69494),
rep('NB09PB03',63303),
rep('NB09PB04',21673),
rep('NB09PB05',102505),
rep('NB09PB06',48880),
rep('NB09PB07',72114),
rep('NB09PB08',57409),
rep('NB10PB01',90329),
rep('NB10PB02',48353),
rep('NB10PB03',37907),
rep('NB10PB04',14247),
rep('NB10PB05',72757),
rep('NB10PB06',34226),
rep('NB10PB07',82226),
rep('NB10PB08',35436),
rep('NB11PB01',110378),
rep('NB11PB02',45448),
rep('NB11PB03',45960),
rep('NB11PB04',16118),
rep('NB11PB05',88355),
rep('NB11PB06',42122),
rep('NB11PB07',96954),
rep('NB11PB08',48685),
rep('NB12PB01',70091),
rep('NB12PB02',24537),
rep('NB12PB03',22002),
rep('NB12PB04',6658),
rep('NB12PB05',46868),
rep('NB12PB06',21291),
rep('NB12PB07',46463),
rep('NB12PB08',22558),
rep('undesigned',5028),
rep('unclassified',1322614))

for (i in c(1:50)){
sampling.num=round(sum(table(data))/i)
sumfail=0
for (j in c(1:i)){
sub=sample(data,sampling.num,replace=T)
#table(sub)[which(table(sub)<560)]
num=length(table(sub)[which(table(sub)<560 & names(table(sub))!='undesigned' & names(table(sub))!='unclassified')])
#print(num)
sumfail=sumfail+num}
cat ("The number of samples: ",i*96,", and ",sumfail," samples with reads less than 560. Percentage of samples having reads >= 560: ",100-(sumfail/(i*96))*100,"\n")
}
